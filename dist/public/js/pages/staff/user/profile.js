"use strict";function _createForOfIteratorHelper(a,b){var c;if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(c=_unsupportedIterableToArray(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var d=0,e=function(){};return{s:e,n:function n(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function e(a){throw a},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function s(){c=a[Symbol.iterator]()},n:function n(){var a=c.next();return g=a.done,a},e:function e(a){h=!0,f=a},f:function f(){try{g||null==c["return"]||c["return"]()}finally{if(h)throw f}}}}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}$("#deleteUserBlurb").click(function(){// delete here
request("/staff/user/"+$("#userId").val()+"/blurb","DELETE").then(function(){success("This user's blurb has been deleted."),$("#userblurb").val("[ Content Deleted ]")})["catch"](function(a){warning(a.responseJSON.message)})}),$("#deleteUserStatus").click(function(){// delete
request("/staff/user/"+$("#userId").val()+"/status","DELETE").then(function(){success("This user's status has been deleted."),$("#userstatus").val("[ Content Deleted ]")})["catch"](function(a){warning(a.responseJSON.message)})}),$("#deleteUserForumSignature").click(function(){// delete
request("/staff/user/"+$("#userId").val()+"/forum/signature","DELETE").then(function(){success("This user's forum signature has been deleted."),$("#userforumsignature").val("[ Content Deleted ]")})["catch"](function(a){warning(a.responseJSON.message)})}),$("#disableTwoFactor").click(function(){questionYesNo("Are you sure you'd like to disable 2FA for this user?",function(){request("/staff/user/"+$("#userId").val()+"/two-factor","DELETE").then(function(){success("This user's two-factor authentication has been disabled."),$("#two-factor-enabled").empty().append("<span style=\"font-weight:600;\" id=\"two-factor-enabled\">2-Factor Enabled: </span><span style=\"font-weight:100;\">No</span>")})["catch"](function(a){warning(a.responseJSON.message)})})}),$("#deleteUserPrimaryBalance").click(function(){questionYesNo("Are you sure you'd like to clear the primary balance of this user?",function(){request("/staff/user/"+$("#userId").val()+"/clear-balance/1","DELETE").then(function(){success("This user's balance has been cleared."),$("#user-balance-primary").empty().append("0")})["catch"](function(a){warning(a.responseJSON.message)})})}),$("#deleteUserSecondaryBalance").click(function(){questionYesNo("Are you sure you'd like to clear the secondary balance of this user?",function(){request("/staff/user/"+$("#userId").val()+"/clear-balance/2","DELETE").then(function(){success("This user's balance has been cleared."),$("#user-balance-secondary").empty().append("0")})["catch"](function(a){warning(a.responseJSON.message)})})}),$(document).on("click","#sendStaffComment",function(){var a=$("#staffCommentText").val();request("/staff/user/"+$("#userId").val()+"/comment","POST",JSON.stringify({comment:a})).then(function(){window.location.reload()})["catch"](function(a){warning(a.responseJSON.message)})}),request("/staff/user/"+$("#userId").val()+"/associated-accounts").then(function(a){var b,c=function(a){return 1===a?"Same IP Address":void 0},d=[],e=_createForOfIteratorHelper(a.accounts);try{for(e.s();!(b=e.n()).done;){var f=b.value;d.push(f.userId),$("#associatedAccountsArray").append("\n        <div class=\"row\" style=\"padding-top:1rem;\">\n            <div class=\"col-12\">\n                <p>Username: <a href=\"/staff/user/profile?userId=".concat(f.userId,"\"><span data-userid=\"").concat(f.userId,"\">N/A</span></a></p>\n                <p>Reason: ").concat(c(f.reason),"</p>\n                <hr />\n            </div>\n        </div>"))}}catch(a){e.e(a)}finally{e.f()}setUserNames(d)})["catch"](function(){$("#associatedAccountsArray").html("<p>There was an error loading the accounts. Try again later.</p>")});/**
 * Load User Profile Comments
 */var commentsLoading=!1,areThereMoreComments=!1,getComments=function(a){commentsLoading||(commentsLoading=!0,request("/staff/user/"+$("#userId").val()+"/comments?offset="+a).then(function(b){var c=[];0===b.comments.length&&0===a&&$("#staffComments").append("\n            <div class=\"col-12\">\n                <p>This user does not have any comments</p>\n            </div>\n            "),25<=b.comments.length&&(areThereMoreComments=!0);var d,e=_createForOfIteratorHelper(b.comments);try{for(e.s();!(d=e.n()).done;){var f=d.value;c.push(f.staffUserId),$("#staffComments").append("\n            <div class=\"col-12\" style=\"padding-top:0.5rem;\">\n                <div class=\"row\">\n                    <div class=\"col-2\">\n                        <img data-userid=\"".concat(f.staffUserId,"\" style=\"width:100%;max-width:150px;margin:0 auto;display: block;\" />\n                        <p class=\"text-center\">\n                            <span data-userid=\"").concat(f.staffUserId,"\" style=\"font-weight:600;\"></span>\n                        </p>\n                        <p class=\"text-center\">\n                            <span>").concat(moment(f.dateCreated).format("DD MMM YYYY"),"</span>\n                        </p>\n                    </div>\n                    <div class=\"col-10\">\n                        <p>").concat(f.comment.escapeAllowFormattingBasic(),"</p>\n                    </div>\n                </div>\n            </div>\n            "))}}catch(a){e.e(a)}finally{e.f()}commentsLoading=!1,setUserThumbs(c),setUserNames(c)})["catch"](function(a){console.log(a),commentsLoading=!1}))};getComments(0);var _isDevLocked=!1;$("#is-developer").change(function(){var a=this;console.log("Change"),$(this).attr("disabled","disabled"),_isDevLocked=!0,request("/staff/user/"+$("#userId").val()+"/game-dev","POST",{isDeveloper:"true"===$(this).val()}).then(function(){toast(!0,"This users game dev state has been modified."),$(a).removeAttr("disabled")})["catch"](function(b){$(a).removeAttr("disabled"),warning(b.responseJSON.message)})}),$(document).on("click","#uncheck-all-full-permissions",function(a){a.preventDefault(),$(".update-permissions-checkbox").each(function(){$(this).attr("checked",!1)})}),$(document).on("click","#update-full-permissions",function(a){a.preventDefault();var b=$("#userId").val();loading(),request("/staff/permissions/"+b,"GET").then(function(){var a=[];$(".update-permissions-checkbox").each(function(){$(this).is(":checked")?a.push({name:$(this).attr("data-permission"),selected:!0}):a.push({name:$(this).attr("data-permission"),selected:!1})});for(var c,d=[],e=0,f=a;e<f.length;e++)c=f[e],c.selected?d.push(request("/staff/permissions/"+b+"/"+c.name,"PUT")["catch"](function(){})):d.push(request("/staff/permissions/"+b+"/"+c.name,"DELETE")["catch"](function(){}));Promise.all(d).then(function(){success("The permissions for this user have been updated.")})["catch"](function(a){throw warning(a.responseJSON.message||"An unknown error has occurred."),console.error(a),a})})["catch"](function(a){throw console.error(a),a})});