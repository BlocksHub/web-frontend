"use strict";function _createForOfIteratorHelper(a,b){var c;if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(c=_unsupportedIterableToArray(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var d=0,e=function(){};return{s:e,n:function n(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function e(a){throw a},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function s(){c=a[Symbol.iterator]()},n:function n(){var a=c.next();return g=a.done,a},e:function e(a){h=!0,f=a},f:function f(){try{g||null==c["return"]||c["return"]()}finally{if(h)throw f}}}}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}$(document).on("click",".submit-reply",function(a){a.preventDefault(),loading();var b=$(this).attr("data-id"),c=$(".reply-body[data-id=\""+b+"\"]").val(),d=$(".reply-mode-on-ticket[data-id=\"".concat(b,"\"]")).val(),e=$(".hide-reply[data-id=\"".concat(b,"\"]")).val(),f=[];f.push(request("/staff/support/ticket/"+b+"/status","PATCH",{status:d})),c&&f.push(request("/staff/support/ticket/"+b+"/reply","POST",{body:c,visibleToClient:e})),Promise.all(f).then(function(){window.location.reload()})["catch"](function(a){warning(a.responseJSON.message)})}),request("/staff/support/tickets-awaiting-response","GET").then(function(a){if(0===a.length)return $("#tickets").empty().append("<p>Thare are no tickets at this time.</p>");a=a.slice(0,5),$("#tickets").empty();var b,c=[],e=_createForOfIteratorHelper(a);try{for(e.s();!(b=e.n()).done;){var f=b.value;$("#tickets").append("\n        \n        <div class=\"row\">\n            <div class=\"col-12 col-lg-6\">\n                <h1 style=\"font-size:1rem;margin-bottom:0;\">".concat(f.ticketTitle.escape(),"</h1>\n                <p style=\"margin-bottom:1rem;\">").concat(f.ticketBody.escape(),"</p>\n                <p>Created ").concat(moment(f.createdAt).fromNow(),"</p>\n                <p>By: <span data-userid=\"").concat(f.userId,"\">Loading...</span></p>\n                <h1 style=\"font-size:1rem;\">Reply</h1>\n                <textarea class=\"form-control reply-body\" data-id=\"").concat(f.ticketId,"\" rows=\"4\" placeholder=\"Reply Text.\" maxlength=\"4096\"></textarea>\n                <div class=\"row\">\n                    <div class=\"col-12\">\n                        <select class=\"form-control hide-reply\" data-id=\"").concat(f.ticketId,"\">\n                            <option value=\"true\">Show Reply to customer</option>\n                            <option value=\"false\">Hide Reply from customer</option>\n                        </select>\n                    </div>\n                    <div class=\"col-8\">\n                        <select class=\"form-control reply-mode-on-ticket\" data-id=\"").concat(f.ticketId,"\">\n                            <option value=\"2\">Require Customer Response</option>\n                            <option value=\"4\">Require More Time</option>\n                            <option value=\"3\">Close</option>\n                        </select>\n                    </div>\n                    <div class=\"col-4\">\n                        <button class=\"btn btn-success submit-reply\" data-id=\"").concat(f.ticketId,"\">Submit</button>\n                    </div>\n                </div>\n            </div>\n            <div class=\"col-12 col-lg-6\" style=\"height:300px;overflow-y:auto;overflow-x:auto;\">\n                <h1 style=\"font-size:1rem;\">Replies</h1>\n                <div class=\"set-replies\" data-id=\"").concat(f.ticketId,"\">\n                </div>\n            </div>\n            <div class=\"col-12\">\n                <hr />\n            </div>\n        </div>\n        \n        \n        ")),c.push(userId)}}catch(a){e.e(a)}finally{e.f()}setUserNames(c),$(".set-replies").each(function(){var a=this,b=$(this).attr("data-id");request("/staff/support/ticket/"+b+"/replies","GET").then(function(b){if(0===b.length)return $(a).append("<p>There are no replies to this ticket.</p>");var c,d=[],e=_createForOfIteratorHelper(b);try{for(e.s();!(c=e.n()).done;){var f=c.value;d.push(f.userId),$(a).append("\n                \n                <div class=\"row\">\n                    <div class=\"col-12\">\n                        <p><span data-userid=\"".concat(f.userId,"\">Loading...</span> - ").concat(moment(f.createdAt).fromNow(),"</p>\n                        <p>").concat(f.ticketBody,"</p>\n                        <hr />\n                    </div>\n                </div>\n                \n                "))}}catch(a){e.e(a)}finally{e.f()}setUserNames(d)})})})["catch"](function(){$("#tickets").empty().append("<p>Thare are no tickets at this time.</p>")}),request("/staff/support/tickets-all","GET").then(function(a){if(0===a.length)return $("#tickets-any-state").empty().append("<p>Thare are no tickets at this time.</p>");a=a.slice(0,5),$("#tickets-any-state").empty();var b,c=[],e=_createForOfIteratorHelper(a);try{for(e.s();!(b=e.n()).done;){var f=b.value;$("#tickets-any-state").append("\n        \n        <div class=\"row\">\n            <div class=\"col-12 col-lg-6\">\n                <h1 style=\"font-size:1rem;margin-bottom:0;\">".concat(f.ticketTitle.escape(),"</h1>\n                <p style=\"margin-bottom:1rem;\">").concat(f.ticketBody.escape(),"</p>\n                <p>Created ").concat(moment(f.createdAt).fromNow(),"</p>\n                <p>By: <span data-userid=\"").concat(f.userId,"\">Loading...</span></p>\n                <h1 style=\"font-size:1rem;\">Reply</h1>\n                <textarea class=\"form-control reply-body\" data-id=\"").concat(f.ticketId,"\" rows=\"4\" placeholder=\"Reply Text.\" maxlength=\"4096\"></textarea>\n                <div class=\"row\">\n                    <div class=\"col-12\">\n                        <select class=\"form-control hide-reply\" data-id=\"").concat(f.ticketId,"\">\n                            <option value=\"true\">Show Reply to customer</option>\n                            <option value=\"false\">Hide Reply from customer</option>\n                        </select>\n                    </div>\n                    <div class=\"col-8\">\n                        <select class=\"form-control reply-mode-on-ticket\" data-id=\"").concat(f.ticketId,"\">\n                            <option value=\"2\">Require Customer Response</option>\n                            <option value=\"4\">Require More Time</option>\n                            <option value=\"3\">Close</option>\n                        </select>\n                    </div>\n                    <div class=\"col-4\">\n                        <button class=\"btn btn-success submit-reply\" data-id=\"").concat(f.ticketId,"\">Submit</button>\n                    </div>\n                </div>\n            </div>\n            <div class=\"col-12 col-lg-6\" style=\"height:300px;overflow-y:auto;overflow-x:auto;\">\n                <h1 style=\"font-size:1rem;\">Replies</h1>\n                <div class=\"set-replies-any\" data-id=\"").concat(f.ticketId,"\">\n                </div>\n            </div>\n            <div class=\"col-12\">\n                <hr />\n            </div>\n        </div>\n        \n        \n        ")),c.push(userId)}}catch(a){e.e(a)}finally{e.f()}setUserNames(c),$(".set-replies-any").each(function(){var a=this,b=$(this).attr("data-id");request("/staff/support/ticket/"+b+"/replies","GET").then(function(b){if(0===b.length)return $(a).append("<p>There are no replies to this ticket.</p>");var c,d=[],e=_createForOfIteratorHelper(b);try{for(e.s();!(c=e.n()).done;){var f=c.value;d.push(f.userId),$(a).append("\n                \n                <div class=\"row\">\n                    <div class=\"col-12\">\n                        <p><span data-userid=\"".concat(f.userId,"\">Loading...</span> - ").concat(moment(f.createdAt).fromNow(),"</p>\n                        <p>").concat(f.ticketBody,"</p>\n                        <hr />\n                    </div>\n                </div>\n                \n                "))}}catch(a){e.e(a)}finally{e.f()}setUserNames(d)})})})["catch"](function(){$("#tickets-any-state").empty().append("<p>Thare are no tickets at this time.</p>")});