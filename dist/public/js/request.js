"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}var _metaDiv=$("#meta");window.HTTPMeta={baseUrl:_metaDiv.attr("data-api-base-url")},"/"===HTTPMeta.baseUrl.slice(HTTPMeta.baseUrl.length-1)&&(HTTPMeta.baseUrl=HTTPMeta.baseUrl.slice(0,HTTPMeta.baseUrl.length-1));function request(a,b,c){return"object"===_typeof(c)&&(c=JSON.stringify(c)),new Promise(function(e,f){function g(d){$.ajax({xhrFields:{withCredentials:!0},type:b,data:c,url:HTTPMeta.baseUrl+"/api/v1"+a,headers:{"content-type":"application/json","x-csrf-token":d,accept:"application/json"},dataType:"json",contentType:"application/json",xhr:function(){var a=jQuery.ajaxSettings.xhr(),b=a.setRequestHeader;return a.setRequestHeader=function(a,c){"X-Requested-With"===a||b.call(this,a,c)},a},complete:function complete(d){if(200===d.status)e(d);else{if(403===d.status)return(h++,10<=h)?f("CSRF Retry count exhausted"):($("#userdata").attr("data-csrf",d.getResponseHeader("x-csrf-token")),g(d.getResponseHeader("x-csrf-token")));d.responseJSON||(d.responseJSON={});var i="ERR1";if(d.responseJSON&&"object"===_typeof(d.responseJSON.error)&&"string"==typeof d.responseJSON.error.code&&(i=d.responseJSON.error.code,d.responseJSON.message=errorTransform(d.responseJSON.error.code)+" Code: "+i),"undefined"==typeof d.responseJSON.message&&(d.responseJSON.message="An unknown error has occurred. Code: "+i),d.responseJSON&&d.responseJSON.error&&"TwoStepVerificationRequired"===d.responseJSON.error.code)return void question("<span style=\"font-size:1rem;font-weight:400;\">For security reasons, please enter your two-factor authentication token to continue.</span>",function(d){c||(c={}),"string"==typeof c&&(c=JSON.parse(c)),c.twoStepToken=d,request(a,b,JSON.stringify(c)).then(function(a){e(a)})["catch"](function(a){f(a)})});if(d.responseJSON&&d.responseJSON.error&&"TwoStepRequiredVerificationFailed"===d.responseJSON.error.code)return void question("<span style=\"font-size:1rem;font-weight:400;\"><span style=\"color:red;\">The code you entered was invalid.</span> For security reasons, please enter your two-factor authentication token to continue.</span>",function(d){c||(c={}),"string"==typeof c&&(c=JSON.parse(c)),c.twoStepToken=d,request(a,b,JSON.stringify(c)).then(function(a){e(a)})["catch"](function(a){f(a)})});f(d)}},failure:function failure(a){a.responseJSON||(a.responseJSON={},a.responseJSON.message="An unknown error has occurred. Code: NET1"),a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.code&&(a.responseJSON.message=errorTransform(a.responseJSON.error.code)),f(a)}})}var h=0;g($("#userdata").attr("data-csrf"))})}"true"===$("#userdata").attr("data-authenticated")&&request("/auth/ping","POST",{url:window.location.href}).then(function(){})["catch"](function(){});